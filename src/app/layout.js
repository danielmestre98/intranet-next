"use client";

import "./globals.css";
import "bootstrap/dist/css/bootstrap.min.css";

import Header from "@/components/Header/Header";
import Providers from "./Redux/provider";
import StyledComponentsRegistry from "./registry";
import { ToastContainer } from "react-toastify";
import "react-toastify/dist/ReactToastify.min.css";
import { useEffect } from "react";
import axios from "@/hooks/axiosInstance";
import { useState } from "react";

export const metadata = {
    title: ":: INTRANET SEDS ::",
    description: "Generated by create next app",
};

export default function RootLayout({ children }) {
    const [isEventAllowed, setIsEventAllowed] = useState(true);
    useEffect(() => {
        const handleFocus = () => {
            // Code to execute when the window gains focus
            if (isEventAllowed) {
                axios.post("/user/last-seen");
                setIsEventAllowed(false);
                setTimeout(() => {
                    setIsEventAllowed(true);
                }, 30000);
            }
        };

        window.addEventListener("focus", handleFocus);

        return () => {
            window.removeEventListener("focus", handleFocus);
        };
    }, [isEventAllowed]);

    return (
        <html lang="pt-br">
            <body>
                <ToastContainer autoClose={5000} newestOnTop={true} theme="colored" hideProgressBar={false} />
                <StyledComponentsRegistry>
                    <Header />
                    <Providers>{children}</Providers>
                </StyledComponentsRegistry>
            </body>
        </html>
    );
}
